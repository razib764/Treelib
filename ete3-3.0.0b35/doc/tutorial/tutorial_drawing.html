

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>The Programmable Tree Drawing Engine &mdash; ETE Toolkit - analysis and visualization of trees</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="author" title="About these documents"
              href="../about.html"/>
    <link rel="top" title="ETE Toolkit - analysis and visualization of trees" href="../index.html"/>
        <link rel="up" title="The ETE tutorial" href="index.html"/>
        <link rel="next" title="Phylogenetic Trees" href="tutorial_phylogeny.html"/>
        <link rel="prev" title="Working With Tree Data Structures" href="tutorial_trees.html"/>
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
           (i[r].q=i[r].q||[]).push(arguments)
    },i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

 ga('create', 'UA-783841-4', 'etetoolkit.org');
 ga('send', 'pageview');
 </script>

<!-- 
 <script type="text/javascript">
 var _gaq = _gaq || [];
 _gaq.push(['_setAccount', 'UA-783841-12']);
 _gaq.push(['_setCookiePath', '/ete2/']);
 _gaq.push(['_trackPageview']);

 (function() {
 var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
 ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
 var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
 })();
 </script>
 -->
<!-- <link rel="canonical" href="http://etetoolkit.org/docs/2.3/CANONICALPATH" />
<meta http-equiv="refresh" content="0; url=http:/etetoolkit.org/CANONICALPATH" />
<script type="text/javascript">
window.location.replace('http://etetoolkit.org/docs/2.3/' + window.location.pathname.replace('/ete2/',''));
</script> -->
 
 


  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> ETE Toolkit
          

          
          </a>

          
            
            
              <div class="version">
                3.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../changelog/index.html">Changelog history</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">The ETE tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="tutorial_trees.html">Working With Tree Data Structures</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">The Programmable Tree Drawing Engine</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#interactive-visualization-of-trees">Interactive visualization of trees</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rendering-trees-as-images">Rendering trees as images</a></li>
<li class="toctree-l3"><a class="reference internal" href="#customizing-the-aspect-of-trees">Customizing the aspect of trees</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tree-style">Tree style</a></li>
<li class="toctree-l4"><a class="reference internal" href="#node-style">Node style</a></li>
<li class="toctree-l4"><a class="reference internal" href="#node-faces">Node faces</a></li>
<li class="toctree-l4"><a class="reference internal" href="#layout-functions">layout functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#combining-styles-faces-and-layouts">Combining styles, faces and layouts</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fixed-node-styles">Fixed node styles</a></li>
<li class="toctree-l4"><a class="reference internal" href="#node-backgrounds">Node backgrounds</a></li>
<li class="toctree-l4"><a class="reference internal" href="#img-faces">Img Faces</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bubble-tree-maps">Bubble tree maps</a></li>
<li class="toctree-l4"><a class="reference internal" href="#trees-within-trees">Trees within trees</a></li>
<li class="toctree-l4"><a class="reference internal" href="#phylogenetic-trees-and-sequence-domains">Phylogenetic trees and sequence domains</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creating-your-custom-interactive-item-faces">Creating your custom interactive Item faces</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_phylogeny.html">Phylogenetic Trees</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_clustering.html">Clustering Trees</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_xml.html">Phylogenetic XML standards</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_webplugin.html">Interactive web tree visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_adaptation.html">Testing Evolutionary Hypothesis</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_ncbitaxonomy.html">Dealing with the NCBI Taxonomy database</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_etree2orthoxml.html">SCRIPTS: orthoXML</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">ETE&#8217;s Reference Guide</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">ETE Toolkit</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">The ETE tutorial</a> &raquo;</li>
      
    <li>The Programmable Tree Drawing Engine</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/tutorial/tutorial_drawing.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="the-programmable-tree-drawing-engine">
<h1><a class="toc-backref" href="#id10">The Programmable Tree Drawing Engine</a><a class="headerlink" href="#the-programmable-tree-drawing-engine" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<span id="drawing"></span><p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#the-programmable-tree-drawing-engine" id="id10">The Programmable Tree Drawing Engine</a><ul>
<li><a class="reference internal" href="#overview" id="id11">Overview</a></li>
<li><a class="reference internal" href="#interactive-visualization-of-trees" id="id12">Interactive visualization of trees</a></li>
<li><a class="reference internal" href="#rendering-trees-as-images" id="id13">Rendering trees as images</a></li>
<li><a class="reference internal" href="#customizing-the-aspect-of-trees" id="id14">Customizing the aspect of trees</a><ul>
<li><a class="reference internal" href="#tree-style" id="id15">Tree style</a><ul>
<li><a class="reference internal" href="#show-leaf-node-names-branch-length-and-branch-support" id="id16">Show leaf node names, branch length and branch support</a></li>
<li><a class="reference internal" href="#change-branch-length-scale-zoom-in-x" id="id17">Change branch length scale (zoom in X)</a></li>
<li><a class="reference internal" href="#change-branch-separation-between-nodes-zoom-in-y" id="id18">Change branch separation between nodes (zoom in Y)</a></li>
<li><a class="reference internal" href="#rotate-a-tree" id="id19">Rotate a tree</a></li>
<li><a class="reference internal" href="#circular-tree-in-180-degrees" id="id20">circular tree in 180 degrees</a></li>
<li><a class="reference internal" href="#add-legend-and-title" id="id21">Add legend and title</a></li>
</ul>
</li>
<li><a class="reference internal" href="#node-style" id="id22">Node style</a></li>
<li><a class="reference internal" href="#node-faces" id="id23">Node faces</a><ul>
<li><a class="reference internal" href="#faces-position" id="id24">Faces position</a></li>
<li><a class="reference internal" href="#face-properties" id="id25">Face properties</a></li>
</ul>
</li>
<li><a class="reference internal" href="#layout-functions" id="id26">layout functions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#combining-styles-faces-and-layouts" id="id27">Combining styles, faces and layouts</a><ul>
<li><a class="reference internal" href="#fixed-node-styles" id="id28">Fixed node styles</a></li>
<li><a class="reference internal" href="#node-backgrounds" id="id29">Node backgrounds</a></li>
<li><a class="reference internal" href="#img-faces" id="id30">Img Faces</a></li>
<li><a class="reference internal" href="#bubble-tree-maps" id="id31">Bubble tree maps</a></li>
<li><a class="reference internal" href="#trees-within-trees" id="id32">Trees within trees</a></li>
<li><a class="reference internal" href="#phylogenetic-trees-and-sequence-domains" id="id33">Phylogenetic trees and sequence domains</a></li>
<li><a class="reference internal" href="#creating-your-custom-interactive-item-faces" id="id34">Creating your custom interactive Item faces</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="overview">
<h2><a class="toc-backref" href="#id11">Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>ETE&#8217;s treeview extension provides a highly programmable drawing system
to render any hierarchical tree structure as PDF, SVG or PNG
images. Although several predefined visualization layouts are included
with the default installation, custom styles can be easily created
from scratch.</p>
<p>Image customization is performed through four elements: <strong>a)</strong>
<a class="reference internal" href="../reference/reference_treeview.html#ete3.TreeStyle" title="ete3.TreeStyle"><code class="xref py py-class docutils literal"><span class="pre">TreeStyle</span></code></a>, setting general options about the image (shape,
rotation, etc.), <strong>b)</strong> <a class="reference internal" href="../reference/reference_treeview.html#ete3.NodeStyle" title="ete3.NodeStyle"><code class="xref py py-class docutils literal"><span class="pre">NodeStyle</span></code></a>, which defines the
specific aspect of each node (size, color, background, line type,
etc.), <strong>c)</strong> node <code class="xref py py-class docutils literal"><span class="pre">faces.Face</span></code> which are small pieces of extra
graphical information that can be added to nodes (text labels, images,
graphs, etc.) <strong>d)</strong> a <code class="xref py py-attr docutils literal"><span class="pre">layout</span></code> function, a normal python
function that controls how node styles and faces are dynamically added
to nodes.</p>
<p>Images can be rendered as <strong>PNG</strong>, <strong>PDF</strong> or <strong>SVG</strong> files using the
<a class="reference internal" href="../reference/reference_tree.html#ete3.TreeNode.render" title="ete3.TreeNode.render"><code class="xref py py-func docutils literal"><span class="pre">TreeNode.render()</span></code></a> method or interactively visualized using a
built-in Graphical User Interface (GUI) invoked by the
<a class="reference internal" href="../reference/reference_tree.html#ete3.TreeNode.show" title="ete3.TreeNode.show"><code class="xref py py-func docutils literal"><span class="pre">TreeNode.show()</span></code></a> method.</p>
</div>
<div class="section" id="interactive-visualization-of-trees">
<h2><a class="toc-backref" href="#id12">Interactive visualization of trees</a><a class="headerlink" href="#interactive-visualization-of-trees" title="Permalink to this headline">¶</a></h2>
<p>ETE&#8217;s tree drawing engine is fully integrated with a built-in
graphical user interface (GUI). Thus, ETE allows to visualize trees
using an interactive interface that allows to explore and manipulate
node&#8217;s properties and tree topology.  To start the visualization of a
node (tree or subtree), you can simply call the <a class="reference internal" href="../reference/reference_tree.html#ete3.TreeNode.show" title="ete3.TreeNode.show"><code class="xref py py-func docutils literal"><span class="pre">TreeNode.show()</span></code></a>
method.</p>
<p>One of the advantages of this on-line GUI visualization is that you
can use it to interrupt a given program/analysis, explore the tree,
manipulate them, and continuing with the execution thread. Note that
<strong>changes made using the GUI will be kept after quiting the
GUI</strong>. This feature is specially useful for using during python
sessions, in which analyses are performed interactively.</p>
<p>The GUI allows many operations to be performed graphically, however it
does not implement all the possibilities of the programming toolkit.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">ete3</span> <span class="kn">import</span> <span class="n">Tree</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span> <span class="s">&quot;((a,b),c);&quot;</span> <span class="p">)</span>
<span class="n">t</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="rendering-trees-as-images">
<h2><a class="toc-backref" href="#id13">Rendering trees as images</a><a class="headerlink" href="#rendering-trees-as-images" title="Permalink to this headline">¶</a></h2>
<p>Tree images can be directly written as image files. SVG, PDF and PNG
formats are supported. Note that, while PNG images are raster images,
PDF and SVG pictures are rendered as <a class="reference external" href="http://en.wikipedia.org/wiki/Vector_graphics">vector graphics</a>, thus allowing its
later modification and scaling.</p>
<p>To generate an image, the <a class="reference internal" href="../reference/reference_tree.html#ete3.TreeNode.render" title="ete3.TreeNode.render"><code class="xref py py-func docutils literal"><span class="pre">TreeNode.render()</span></code></a> method should be
used instead of <a class="reference internal" href="../reference/reference_tree.html#ete3.TreeNode.show" title="ete3.TreeNode.show"><code class="xref py py-func docutils literal"><span class="pre">TreeNode.show()</span></code></a>. The only required argument is
the file name, whose extension will determine the image format (.PDF,
.SVG or .PNG). Several parameters regarding the image size and
resolution can be adjusted:</p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Argument</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="xref py py-attr docutils literal"><span class="pre">units</span></code></td>
<td>&#8220;<strong>px</strong>&#8221;: pixels, &#8220;<strong>mm</strong>&#8221;: millimeters, &#8220;<strong>in</strong>&#8221;: inches</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-attr docutils literal"><span class="pre">h</span></code></td>
<td>height of the image in <code class="xref py py-attr docutils literal"><span class="pre">units</span></code>.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-attr docutils literal"><span class="pre">w</span></code></td>
<td>width of the image in <code class="xref py py-attr docutils literal"><span class="pre">units</span></code>.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-attr docutils literal"><span class="pre">dpi</span></code></td>
<td>dots per inches.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If <code class="xref py py-attr docutils literal"><span class="pre">h</span></code> and <code class="xref py py-attr docutils literal"><span class="pre">w</span></code> values are both provided, image size
will be adjusted even if it requires to break the original aspect
ratio of the image. If only one value (<code class="xref py py-attr docutils literal"><span class="pre">h</span></code> or <code class="xref py py-attr docutils literal"><span class="pre">w</span></code>) is
provided, the other will be estimated to maintain aspect ratio. If
no sizing values are provided, image will be adjusted to A4
dimensions.</p>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">ete3</span> <span class="kn">import</span> <span class="n">Tree</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span> <span class="s">&quot;((a,b),c);&quot;</span> <span class="p">)</span>
<span class="n">t</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s">&quot;mytree.png&quot;</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="mi">183</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;mm&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="customizing-the-aspect-of-trees">
<h2><a class="toc-backref" href="#id14">Customizing the aspect of trees</a><a class="headerlink" href="#customizing-the-aspect-of-trees" title="Permalink to this headline">¶</a></h2>
<p>Image customization is performed through four main elements:</p>
<div class="section" id="tree-style">
<h3><a class="toc-backref" href="#id15">Tree style</a><a class="headerlink" href="#tree-style" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="../reference/reference_treeview.html#ete3.TreeStyle" title="ete3.TreeStyle"><code class="xref py py-class docutils literal"><span class="pre">TreeStyle</span></code></a> class can be used to create a custom set of
options that control the general aspect of the tree image. Tree styles
can be passed to the <a class="reference internal" href="../reference/reference_tree.html#ete3.TreeNode.show" title="ete3.TreeNode.show"><code class="xref py py-func docutils literal"><span class="pre">TreeNode.show()</span></code></a> and <a class="reference internal" href="../reference/reference_tree.html#ete3.TreeNode.render" title="ete3.TreeNode.render"><code class="xref py py-func docutils literal"><span class="pre">TreeNode.render()</span></code></a>
methods.  For instance, <a class="reference internal" href="../reference/reference_treeview.html#ete3.TreeStyle" title="ete3.TreeStyle"><code class="xref py py-class docutils literal"><span class="pre">TreeStyle</span></code></a> allows to modify the scale
used to render tree branches or choose between circular or rectangular
tree drawing modes.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">ete3</span> <span class="kn">import</span> <span class="n">Tree</span><span class="p">,</span> <span class="n">TreeStyle</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span> <span class="s">&quot;((a,b),c);&quot;</span> <span class="p">)</span>
<span class="n">circular_style</span> <span class="o">=</span> <span class="n">TreeStyle</span><span class="p">()</span>
<span class="n">circular_style</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s">&quot;c&quot;</span> <span class="c"># draw tree in circular mode</span>
<span class="n">circular_style</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">t</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s">&quot;mytree.png&quot;</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="mi">183</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s">&quot;mm&quot;</span><span class="p">,</span> <span class="n">tree_style</span><span class="o">=</span><span class="n">circular_style</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">A number of parameters can be controlled through custom
tree style objects, check <a class="reference internal" href="../reference/reference_treeview.html#ete3.TreeStyle" title="ete3.TreeStyle"><code class="xref py py-class docutils literal"><span class="pre">TreeStyle</span></code></a> documentation for a
complete list of accepted values.</p>
</div>
<p>Some common uses include:</p>
<div class="section" id="show-leaf-node-names-branch-length-and-branch-support">
<h4><a class="toc-backref" href="#id16">Show leaf node names, branch length and branch support</a><a class="headerlink" href="#show-leaf-node-names-branch-length-and-branch-support" title="Permalink to this headline">¶</a></h4>
<div class="figure" id="id1">
<img alt="../_images/show_info.png" src="../_images/show_info.png" />
<p class="caption"><span class="caption-text">Automatically adds node names and branch information to the tree image:</span></p>
<div class="legend">
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">ete3</span> <span class="kn">import</span> <span class="n">Tree</span><span class="p">,</span> <span class="n">TreeStyle</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">()</span>
<span class="n">t</span><span class="o">.</span><span class="n">populate</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_dist</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">TreeStyle</span><span class="p">()</span>
<span class="n">ts</span><span class="o">.</span><span class="n">show_leaf_name</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">ts</span><span class="o">.</span><span class="n">show_branch_length</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">ts</span><span class="o">.</span><span class="n">show_branch_support</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">t</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">tree_style</span><span class="o">=</span><span class="n">ts</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="change-branch-length-scale-zoom-in-x">
<h4><a class="toc-backref" href="#id17">Change branch length scale (zoom in X)</a><a class="headerlink" href="#change-branch-length-scale-zoom-in-x" title="Permalink to this headline">¶</a></h4>
<div class="figure" id="id2">
<img alt="../_images/scale_x.png" src="../_images/scale_x.png" />
<p class="caption"><span class="caption-text">Increases the length of the tree by changing the scale:</span></p>
<div class="legend">
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">ete3</span> <span class="kn">import</span> <span class="n">Tree</span><span class="p">,</span> <span class="n">TreeStyle</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">()</span>
<span class="n">t</span><span class="o">.</span><span class="n">populate</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_dist</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">TreeStyle</span><span class="p">()</span>
<span class="n">ts</span><span class="o">.</span><span class="n">show_leaf_name</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">ts</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span>  <span class="mi">120</span> <span class="c"># 120 pixels per branch length unit</span>
<span class="n">t</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">tree_style</span><span class="o">=</span><span class="n">ts</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="change-branch-separation-between-nodes-zoom-in-y">
<h4><a class="toc-backref" href="#id18">Change branch separation between nodes (zoom in Y)</a><a class="headerlink" href="#change-branch-separation-between-nodes-zoom-in-y" title="Permalink to this headline">¶</a></h4>
<div class="figure" id="id3">
<img alt="../_images/scale_y.png" src="../_images/scale_y.png" />
<p class="caption"><span class="caption-text">Increases the separation between leaf branches:</span></p>
<div class="legend">
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">ete3</span> <span class="kn">import</span> <span class="n">Tree</span><span class="p">,</span> <span class="n">TreeStyle</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">()</span>
<span class="n">t</span><span class="o">.</span><span class="n">populate</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_dist</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">TreeStyle</span><span class="p">()</span>
<span class="n">ts</span><span class="o">.</span><span class="n">show_leaf_name</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">ts</span><span class="o">.</span><span class="n">branch_vertical_margin</span> <span class="o">=</span> <span class="mi">10</span> <span class="c"># 10 pixels between adjacent branches</span>
<span class="n">t</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">tree_style</span><span class="o">=</span><span class="n">ts</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="rotate-a-tree">
<h4><a class="toc-backref" href="#id19">Rotate a tree</a><a class="headerlink" href="#rotate-a-tree" title="Permalink to this headline">¶</a></h4>
<div class="figure" id="id4">
<img alt="../_images/rotated_tree.png" src="../_images/rotated_tree.png" />
<p class="caption"><span class="caption-text">Draws a rectangular tree from top to bottom:</span></p>
<div class="legend">
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">ete3</span> <span class="kn">import</span> <span class="n">Tree</span><span class="p">,</span> <span class="n">TreeStyle</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">()</span>
<span class="n">t</span><span class="o">.</span><span class="n">populate</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">TreeStyle</span><span class="p">()</span>
<span class="n">ts</span><span class="o">.</span><span class="n">show_leaf_name</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">ts</span><span class="o">.</span><span class="n">rotation</span> <span class="o">=</span> <span class="mi">90</span>
<span class="n">t</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">tree_style</span><span class="o">=</span><span class="n">ts</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="circular-tree-in-180-degrees">
<h4><a class="toc-backref" href="#id20">circular tree in 180 degrees</a><a class="headerlink" href="#circular-tree-in-180-degrees" title="Permalink to this headline">¶</a></h4>
<div class="figure" id="id5">
<img alt="../_images/semi_circular_tree.png" src="../_images/semi_circular_tree.png" />
<p class="caption"><span class="caption-text">Draws a circular tree using a semi-circumference:</span></p>
<div class="legend">
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">ete3</span> <span class="kn">import</span> <span class="n">Tree</span><span class="p">,</span> <span class="n">TreeStyle</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">()</span>
<span class="n">t</span><span class="o">.</span><span class="n">populate</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">TreeStyle</span><span class="p">()</span>
<span class="n">ts</span><span class="o">.</span><span class="n">show_leaf_name</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">ts</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s">&quot;c&quot;</span>
<span class="n">ts</span><span class="o">.</span><span class="n">arc_start</span> <span class="o">=</span> <span class="o">-</span><span class="mi">180</span> <span class="c"># 0 degrees = 3 o&#39;clock</span>
<span class="n">ts</span><span class="o">.</span><span class="n">arc_span</span> <span class="o">=</span> <span class="mi">180</span>
<span class="n">t</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">tree_style</span><span class="o">=</span><span class="n">ts</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="add-legend-and-title">
<h4><a class="toc-backref" href="#id21">Add legend and title</a><a class="headerlink" href="#add-legend-and-title" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">ete3</span> <span class="kn">import</span> <span class="n">Tree</span><span class="p">,</span> <span class="n">TreeStyle</span><span class="p">,</span> <span class="n">TextFace</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span> <span class="s">&quot;((a,b),c);&quot;</span> <span class="p">)</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">TreeStyle</span><span class="p">()</span>
<span class="n">ts</span><span class="o">.</span><span class="n">show_leaf_name</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">ts</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">add_face</span><span class="p">(</span><span class="n">TextFace</span><span class="p">(</span><span class="s">&quot;Hello ETE&quot;</span><span class="p">,</span> <span class="n">fsize</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">t</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">tree_style</span><span class="o">=</span><span class="n">ts</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="node-style">
<h3><a class="toc-backref" href="#id22">Node style</a><a class="headerlink" href="#node-style" title="Permalink to this headline">¶</a></h3>
<p>Through the <a class="reference internal" href="../reference/reference_treeview.html#ete3.NodeStyle" title="ete3.NodeStyle"><code class="xref py py-class docutils literal"><span class="pre">NodeStyle</span></code></a> class the aspect of each single node
can be controlled, including its size, color, background and branch type.</p>
<p>A node style can be defined statically and attached to several nodes:</p>
<div class="figure" id="id6">
<img alt="../_images/node_style_red_nodes.png" src="../_images/node_style_red_nodes.png" />
<p class="caption"><span class="caption-text">Simple tree in which the same style is applied to all nodes:</span></p>
<div class="legend">
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">ete3</span> <span class="kn">import</span> <span class="n">Tree</span><span class="p">,</span> <span class="n">NodeStyle</span><span class="p">,</span> <span class="n">TreeStyle</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span> <span class="s">&quot;((a,b),c);&quot;</span> <span class="p">)</span>

<span class="c"># Basic tree style</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">TreeStyle</span><span class="p">()</span>
<span class="n">ts</span><span class="o">.</span><span class="n">show_leaf_name</span> <span class="o">=</span> <span class="bp">True</span>

<span class="c"># Draws nodes as small red spheres of diameter equal to 10 pixels</span>
<span class="n">nstyle</span> <span class="o">=</span> <span class="n">NodeStyle</span><span class="p">()</span>
<span class="n">nstyle</span><span class="p">[</span><span class="s">&quot;shape&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;sphere&quot;</span>
<span class="n">nstyle</span><span class="p">[</span><span class="s">&quot;size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">nstyle</span><span class="p">[</span><span class="s">&quot;fgcolor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;darkred&quot;</span>

<span class="c"># Gray dashed branch lines</span>
<span class="n">nstyle</span><span class="p">[</span><span class="s">&quot;hz_line_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">nstyle</span><span class="p">[</span><span class="s">&quot;hz_line_color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;#cccccc&quot;</span>

<span class="c"># Applies the same static style to all nodes in the tree. Note that,</span>
<span class="c"># if &quot;nstyle&quot; is modified, changes will affect to all nodes</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">traverse</span><span class="p">():</span>
   <span class="n">n</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">nstyle</span><span class="p">)</span>

<span class="n">t</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">tree_style</span><span class="o">=</span><span class="n">ts</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>If you want to draw nodes with different styles, an independent
<a class="reference internal" href="../reference/reference_treeview.html#ete3.NodeStyle" title="ete3.NodeStyle"><code class="xref py py-class docutils literal"><span class="pre">NodeStyle</span></code></a> instance must be created for each node. Note that
node styles can be modified at any moment by accessing the
<a class="reference internal" href="../reference/reference_tree.html#ete3.TreeNode.img_style" title="ete3.TreeNode.img_style"><code class="xref py py-attr docutils literal"><span class="pre">TreeNode.img_style</span></code></a> attribute.</p>
<div class="figure" id="id7">
<img alt="../_images/node_style_red_and_blue_nodes.png" src="../_images/node_style_red_and_blue_nodes.png" />
<p class="caption"><span class="caption-text">Simple tree in which the different styles are applied to each node:</span></p>
<div class="legend">
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">ete3</span> <span class="kn">import</span> <span class="n">Tree</span><span class="p">,</span> <span class="n">NodeStyle</span><span class="p">,</span> <span class="n">TreeStyle</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span> <span class="s">&quot;((a,b),c);&quot;</span> <span class="p">)</span>

<span class="c"># Basic tree style</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">TreeStyle</span><span class="p">()</span>
<span class="n">ts</span><span class="o">.</span><span class="n">show_leaf_name</span> <span class="o">=</span> <span class="bp">True</span>

<span class="c"># Creates an independent node style for each node, which is</span>
<span class="c"># initialized with a red foreground color.</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">traverse</span><span class="p">():</span>
   <span class="n">nstyle</span> <span class="o">=</span> <span class="n">NodeStyle</span><span class="p">()</span>
   <span class="n">nstyle</span><span class="p">[</span><span class="s">&quot;fgcolor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;red&quot;</span>
   <span class="n">nstyle</span><span class="p">[</span><span class="s">&quot;size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">15</span>
   <span class="n">n</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">nstyle</span><span class="p">)</span>

<span class="c"># Let&#39;s now modify the aspect of the root node</span>
<span class="n">t</span><span class="o">.</span><span class="n">img_style</span><span class="p">[</span><span class="s">&quot;size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">t</span><span class="o">.</span><span class="n">img_style</span><span class="p">[</span><span class="s">&quot;fgcolor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;blue&quot;</span>

<span class="n">t</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">tree_style</span><span class="o">=</span><span class="n">ts</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Static node styles, set through the <code class="xref py py-func docutils literal"><span class="pre">set_style()</span></code> method, will be
attached to the nodes and exported as part of their information. For
instance, <a class="reference internal" href="../reference/reference_tree.html#ete3.TreeNode.copy" title="ete3.TreeNode.copy"><code class="xref py py-func docutils literal"><span class="pre">TreeNode.copy()</span></code></a> will replicate all node styles in the
replicate tree. Note that node styles can be also modified on the fly
through a <code class="xref py py-attr docutils literal"><span class="pre">layout</span></code> function (see <a class="reference internal" href="#sec-layout-functions"><span>layout functions</span></a>)</p>
</div>
<div class="section" id="node-faces">
<span id="sec-node-faces"></span><h3><a class="toc-backref" href="#id23">Node faces</a><a class="headerlink" href="#node-faces" title="Permalink to this headline">¶</a></h3>
<p>Node faces are small pieces of graphical information that can be
linked to nodes. For instance, text labels or external images could be
linked to nodes and they will be plotted within the tree image.</p>
<p>Several types of node faces are provided by the main <a class="reference internal" href="tutorial_trees.html#module-ete3" title="ete3: provides main objects and modules"><code class="xref py py-mod docutils literal"><span class="pre">ete3</span></code></a>
module, ranging from simple text (<code class="xref py py-class docutils literal"><span class="pre">TextFace</span></code>) and geometric
shapes (<code class="xref py py-class docutils literal"><span class="pre">CircleFace</span></code>), to molecular sequence representations
(<code class="xref py py-class docutils literal"><span class="pre">SequenceFace</span></code>), heatmaps and profile plots
(<code class="xref py py-class docutils literal"><span class="pre">ProfileFace</span></code>). A complete list of available faces can be
found at the <a class="reference internal" href="../reference/reference_treeview.html#module-ete3.treeview" title="ete3.treeview"><code class="xref py py-mod docutils literal"><span class="pre">ete3.treeview</span></code></a> reference page..</p>
<div class="section" id="faces-position">
<h4><a class="toc-backref" href="#id24">Faces position</a><a class="headerlink" href="#faces-position" title="Permalink to this headline">¶</a></h4>
<p>Faces can be added to different areas around the node, namely
<strong>branch-right</strong>, <strong>branch-top</strong>, <strong>branch-bottom</strong> or <strong>aligned</strong>.
Each area represents a table in which faces can be added through the
<code class="xref py py-func docutils literal"><span class="pre">TreeNode.add_face()</span></code> method. For instance, if two text labels
want to be drawn bellow the branch line of a given node, a pair of
<code class="xref py py-class docutils literal"><span class="pre">TextFace</span></code> faces can be created and added to the columns 0
and 1 of the <strong>branch-bottom</strong> area:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">ete3</span> <span class="kn">import</span> <span class="n">Tree</span><span class="p">,</span> <span class="n">TreeStyle</span><span class="p">,</span> <span class="n">TextFace</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span> <span class="s">&quot;((a,b),c);&quot;</span> <span class="p">)</span>

<span class="c"># Basic tree style</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">TreeStyle</span><span class="p">()</span>
<span class="n">ts</span><span class="o">.</span><span class="n">show_leaf_name</span> <span class="o">=</span> <span class="bp">True</span>

<span class="c"># Add two text faces to different columns</span>
<span class="n">t</span><span class="o">.</span><span class="n">add_face</span><span class="p">(</span><span class="n">TextFace</span><span class="p">(</span><span class="s">&quot;hola &quot;</span><span class="p">),</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">position</span> <span class="o">=</span> <span class="s">&quot;branch-right&quot;</span><span class="p">)</span>
<span class="n">t</span><span class="o">.</span><span class="n">add_face</span><span class="p">(</span><span class="n">TextFace</span><span class="p">(</span><span class="s">&quot;mundo!&quot;</span><span class="p">),</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">position</span> <span class="o">=</span> <span class="s">&quot;branch-right&quot;</span><span class="p">)</span>
<span class="n">t</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">tree_style</span><span class="o">=</span><span class="n">ts</span><span class="p">)</span>
</pre></div>
</div>
<p>If you add more than one face to the same area and column, they will
be piled up. See the following image as an example of face positions:</p>
<blockquote>
<div><div class="figure" id="id8">
<img alt="possible face positions" src="../_images/face_positions.png" />
<p class="caption"><span class="caption-text"><a class="reference download internal" href="../_downloads/face_grid.py"><code class="xref download docutils literal"><span class="pre">Source</span> <span class="pre">code</span></code></a> used to generate the
above image.</span></p>
</div>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Once a face object is created, it can be linked to one or more
nodes. For instance, the same text label can be recycled and added
to several nodes.</p>
</div>
</div>
<div class="section" id="face-properties">
<h4><a class="toc-backref" href="#id25">Face properties</a><a class="headerlink" href="#face-properties" title="Permalink to this headline">¶</a></h4>
<p>Apart from the specific config values of each face type, all face
instances contain same basic attributes that permit to modify general
aspects such as margins, background colors, border, etc. A complete
list of face attributes can be found in the general <code class="xref py py-class docutils literal"><span class="pre">Face</span></code>
class documentation. Here is a very simple example:</p>
<div class="figure" id="id9">
<img alt="../_images/face_borders.png" src="../_images/face_borders.png" />
<p class="caption"><span class="caption-text">Basic use of face general attributes</span></p>
<div class="legend">
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">ete3</span> <span class="kn">import</span> <span class="n">Tree</span><span class="p">,</span> <span class="n">TreeStyle</span><span class="p">,</span> <span class="n">TextFace</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span> <span class="s">&quot;(a,b);&quot;</span> <span class="p">)</span>

<span class="c"># Basic tree style</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">TreeStyle</span><span class="p">()</span>
<span class="n">ts</span><span class="o">.</span><span class="n">show_leaf_name</span> <span class="o">=</span> <span class="bp">True</span>

<span class="c"># Creates two faces</span>
<span class="n">hola</span> <span class="o">=</span> <span class="n">TextFace</span><span class="p">(</span><span class="s">&quot;hola&quot;</span><span class="p">)</span>
<span class="n">mundo</span> <span class="o">=</span> <span class="n">TextFace</span><span class="p">(</span><span class="s">&quot;mundo&quot;</span><span class="p">)</span>

<span class="c"># Set some attributes</span>
<span class="n">hola</span><span class="o">.</span><span class="n">margin_top</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">hola</span><span class="o">.</span><span class="n">margin_right</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">hola</span><span class="o">.</span><span class="n">margin_left</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">hola</span><span class="o">.</span><span class="n">margin_bottom</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">hola</span><span class="o">.</span><span class="n">opacity</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="c"># from 0 to 1</span>
<span class="n">hola</span><span class="o">.</span><span class="n">inner_border</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="mi">1</span> <span class="c"># 1 pixel border</span>
<span class="n">hola</span><span class="o">.</span><span class="n">inner_border</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c"># dashed line</span>
<span class="n">hola</span><span class="o">.</span><span class="n">border</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">hola</span><span class="o">.</span><span class="n">background</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="s">&quot;LightGreen&quot;</span>

<span class="n">t</span><span class="o">.</span><span class="n">add_face</span><span class="p">(</span><span class="n">hola</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">position</span> <span class="o">=</span> <span class="s">&quot;branch-top&quot;</span><span class="p">)</span>
<span class="n">t</span><span class="o">.</span><span class="n">add_face</span><span class="p">(</span><span class="n">mundo</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">position</span> <span class="o">=</span> <span class="s">&quot;branch-bottom&quot;</span><span class="p">)</span>

<span class="n">t</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">tree_style</span><span class="o">=</span><span class="n">ts</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="layout-functions">
<span id="sec-layout-functions"></span><h3><a class="toc-backref" href="#id26">layout functions</a><a class="headerlink" href="#layout-functions" title="Permalink to this headline">¶</a></h3>
<p>Layout functions act as pre-drawing <a class="reference external" href="http://en.wikipedia.org/wiki/Hooking">hooking functions</a>. This means, when a node is
about to be drawn, it is first sent to a layout function.  Node
properties, style and faces can be then modified on the fly and return
it to the drawer engine. Thus, layout functions can be understood as a
collection of rules controlling how different nodes should be drawn.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">ete3</span> <span class="kn">import</span> <span class="n">Tree</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span> <span class="s">&quot;((((a,b),c), d), e);&quot;</span> <span class="p">)</span>

<span class="k">def</span> <span class="nf">abc_layout</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
    <span class="n">vowels</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="s">&quot;e&quot;</span><span class="p">,</span> <span class="s">&quot;i&quot;</span><span class="p">,</span> <span class="s">&quot;o&quot;</span><span class="p">,</span> <span class="s">&quot;u&quot;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">vowels</span><span class="p">:</span>

       <span class="c"># Note that node style are already initialized with the</span>
       <span class="c"># default values</span>

       <span class="n">node</span><span class="o">.</span><span class="n">img_style</span><span class="p">[</span><span class="s">&quot;size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">15</span>
       <span class="n">node</span><span class="o">.</span><span class="n">img_style</span><span class="p">[</span><span class="s">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;red&quot;</span>

<span class="c"># Basic tree style</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">TreeStyle</span><span class="p">()</span>
<span class="n">ts</span><span class="o">.</span><span class="n">show_leaf_name</span> <span class="o">=</span> <span class="bp">True</span>

<span class="c"># Add two text faces to different columns</span>
<span class="n">t</span><span class="o">.</span><span class="n">add_face</span><span class="p">(</span><span class="n">TextFace</span><span class="p">(</span><span class="s">&quot;hola &quot;</span><span class="p">),</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">position</span> <span class="o">=</span> <span class="s">&quot;branch-right&quot;</span><span class="p">)</span>
<span class="n">t</span><span class="o">.</span><span class="n">add_face</span><span class="p">(</span><span class="n">TextFace</span><span class="p">(</span><span class="s">&quot;mundo!&quot;</span><span class="p">),</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">position</span> <span class="o">=</span> <span class="s">&quot;branch-right&quot;</span><span class="p">)</span>
<span class="n">t</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">tree_style</span><span class="o">=</span><span class="n">ts</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="combining-styles-faces-and-layouts">
<h2><a class="toc-backref" href="#id27">Combining styles, faces and layouts</a><a class="headerlink" href="#combining-styles-faces-and-layouts" title="Permalink to this headline">¶</a></h2>
<p>Examples are probably the best way to show how ETE works:</p>
<div class="section" id="fixed-node-styles">
<h3><a class="toc-backref" href="#id28">Fixed node styles</a><a class="headerlink" href="#fixed-node-styles" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><div class="figure">
<img alt="../_images/node_style.png" src="../_images/node_style.png" />
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">ete3</span> <span class="kn">import</span> <span class="n">Tree</span><span class="p">,</span> <span class="n">faces</span><span class="p">,</span> <span class="n">AttrFace</span><span class="p">,</span> <span class="n">TreeStyle</span><span class="p">,</span> <span class="n">NodeStyle</span>

<span class="k">def</span> <span class="nf">layout</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
    <span class="c"># If node is a leaf, add the nodes name and a its scientific name</span>
    <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">is_leaf</span><span class="p">():</span>
        <span class="n">faces</span><span class="o">.</span><span class="n">add_face_to_node</span><span class="p">(</span><span class="n">AttrFace</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">),</span> <span class="n">node</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_example_tree</span><span class="p">():</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">()</span>
    <span class="n">t</span><span class="o">.</span><span class="n">populate</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>

    <span class="c"># Node style handling is no longer limited to layout functions. You</span>
    <span class="c"># can now create fixed node styles and use them many times, save them</span>
    <span class="c"># or even add them to nodes before drawing (this allows to save and</span>
    <span class="c"># reproduce an tree image design)</span>

    <span class="c"># Set bold red branch to the root node</span>
    <span class="n">style</span> <span class="o">=</span> <span class="n">NodeStyle</span><span class="p">()</span>
    <span class="n">style</span><span class="p">[</span><span class="s">&quot;fgcolor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;#0f0f0f&quot;</span>
    <span class="n">style</span><span class="p">[</span><span class="s">&quot;size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">style</span><span class="p">[</span><span class="s">&quot;vt_line_color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;#ff0000&quot;</span>
    <span class="n">style</span><span class="p">[</span><span class="s">&quot;hz_line_color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;#ff0000&quot;</span>
    <span class="n">style</span><span class="p">[</span><span class="s">&quot;vt_line_width&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">style</span><span class="p">[</span><span class="s">&quot;hz_line_width&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">style</span><span class="p">[</span><span class="s">&quot;vt_line_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="c"># 0 solid, 1 dashed, 2 dotted</span>
    <span class="n">style</span><span class="p">[</span><span class="s">&quot;hz_line_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">t</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">style</span><span class="p">)</span>

    <span class="c">#Set dotted red lines to the first two branches</span>
    <span class="n">style1</span> <span class="o">=</span> <span class="n">NodeStyle</span><span class="p">()</span>
    <span class="n">style1</span><span class="p">[</span><span class="s">&quot;fgcolor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;#0f0f0f&quot;</span>
    <span class="n">style1</span><span class="p">[</span><span class="s">&quot;size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">style1</span><span class="p">[</span><span class="s">&quot;vt_line_color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;#ff0000&quot;</span>
    <span class="n">style1</span><span class="p">[</span><span class="s">&quot;hz_line_color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;#ff0000&quot;</span>
    <span class="n">style1</span><span class="p">[</span><span class="s">&quot;vt_line_width&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">style1</span><span class="p">[</span><span class="s">&quot;hz_line_width&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">style1</span><span class="p">[</span><span class="s">&quot;vt_line_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="c"># 0 solid, 1 dashed, 2 dotted</span>
    <span class="n">style1</span><span class="p">[</span><span class="s">&quot;hz_line_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">t</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">img_style</span> <span class="o">=</span> <span class="n">style1</span>
    <span class="n">t</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">img_style</span> <span class="o">=</span> <span class="n">style1</span>

    <span class="c"># Set dashed blue lines in all leaves</span>
    <span class="n">style2</span> <span class="o">=</span> <span class="n">NodeStyle</span><span class="p">()</span>
    <span class="n">style2</span><span class="p">[</span><span class="s">&quot;fgcolor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;#000000&quot;</span>
    <span class="n">style2</span><span class="p">[</span><span class="s">&quot;shape&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;circle&quot;</span>
    <span class="n">style2</span><span class="p">[</span><span class="s">&quot;vt_line_color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;#0000aa&quot;</span>
    <span class="n">style2</span><span class="p">[</span><span class="s">&quot;hz_line_color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;#0000aa&quot;</span>
    <span class="n">style2</span><span class="p">[</span><span class="s">&quot;vt_line_width&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">style2</span><span class="p">[</span><span class="s">&quot;hz_line_width&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">style2</span><span class="p">[</span><span class="s">&quot;vt_line_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="c"># 0 solid, 1 dashed, 2 dotted</span>
    <span class="n">style2</span><span class="p">[</span><span class="s">&quot;hz_line_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">iter_leaves</span><span class="p">():</span>
        <span class="n">l</span><span class="o">.</span><span class="n">img_style</span> <span class="o">=</span> <span class="n">style2</span>

    <span class="n">ts</span> <span class="o">=</span> <span class="n">TreeStyle</span><span class="p">()</span>
    <span class="n">ts</span><span class="o">.</span><span class="n">layout_fn</span> <span class="o">=</span> <span class="n">layout</span>
    <span class="n">ts</span><span class="o">.</span><span class="n">show_leaf_name</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="k">return</span> <span class="n">t</span><span class="p">,</span> <span class="n">ts</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">ts</span> <span class="o">=</span> <span class="n">get_example_tree</span><span class="p">()</span>
    <span class="n">t</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">tree_style</span><span class="o">=</span><span class="n">ts</span><span class="p">)</span>
    <span class="c">#t.render(&quot;node_style.png&quot;, w=400, tree_style=ts)</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="node-backgrounds">
<h3><a class="toc-backref" href="#id29">Node backgrounds</a><a class="headerlink" href="#node-backgrounds" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><div class="figure">
<img alt="../_images/node_background.png" src="../_images/node_background.png" />
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">ete3</span> <span class="kn">import</span> <span class="n">Tree</span><span class="p">,</span> <span class="n">faces</span><span class="p">,</span> <span class="n">AttrFace</span><span class="p">,</span> <span class="n">TreeStyle</span><span class="p">,</span> <span class="n">NodeStyle</span>

<span class="k">def</span> <span class="nf">layout</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">is_leaf</span><span class="p">():</span>
        <span class="n">N</span> <span class="o">=</span> <span class="n">AttrFace</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">,</span> <span class="n">fsize</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
        <span class="n">faces</span><span class="o">.</span><span class="n">add_face_to_node</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s">&quot;aligned&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_example_tree</span><span class="p">():</span>

    <span class="c"># Set dashed blue lines in all leaves</span>
    <span class="n">nst1</span> <span class="o">=</span> <span class="n">NodeStyle</span><span class="p">()</span>
    <span class="n">nst1</span><span class="p">[</span><span class="s">&quot;bgcolor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;LightSteelBlue&quot;</span>
    <span class="n">nst2</span> <span class="o">=</span> <span class="n">NodeStyle</span><span class="p">()</span>
    <span class="n">nst2</span><span class="p">[</span><span class="s">&quot;bgcolor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;Moccasin&quot;</span>
    <span class="n">nst3</span> <span class="o">=</span> <span class="n">NodeStyle</span><span class="p">()</span>
    <span class="n">nst3</span><span class="p">[</span><span class="s">&quot;bgcolor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;DarkSeaGreen&quot;</span>
    <span class="n">nst4</span> <span class="o">=</span> <span class="n">NodeStyle</span><span class="p">()</span>
    <span class="n">nst4</span><span class="p">[</span><span class="s">&quot;bgcolor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;Khaki&quot;</span>


    <span class="n">t</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="s">&quot;((((a1,a2),a3), ((b1,b2),(b3,b4))), ((c1,c2),c3));&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">traverse</span><span class="p">():</span>
        <span class="n">n</span><span class="o">.</span><span class="n">dist</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">n1</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">get_common_ancestor</span><span class="p">(</span><span class="s">&quot;a1&quot;</span><span class="p">,</span> <span class="s">&quot;a2&quot;</span><span class="p">,</span> <span class="s">&quot;a3&quot;</span><span class="p">)</span>
    <span class="n">n1</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">nst1</span><span class="p">)</span>
    <span class="n">n2</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">get_common_ancestor</span><span class="p">(</span><span class="s">&quot;b1&quot;</span><span class="p">,</span> <span class="s">&quot;b2&quot;</span><span class="p">,</span> <span class="s">&quot;b3&quot;</span><span class="p">,</span> <span class="s">&quot;b4&quot;</span><span class="p">)</span>
    <span class="n">n2</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">nst2</span><span class="p">)</span>
    <span class="n">n3</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">get_common_ancestor</span><span class="p">(</span><span class="s">&quot;c1&quot;</span><span class="p">,</span> <span class="s">&quot;c2&quot;</span><span class="p">,</span> <span class="s">&quot;c3&quot;</span><span class="p">)</span>
    <span class="n">n3</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">nst3</span><span class="p">)</span>
    <span class="n">n4</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">get_common_ancestor</span><span class="p">(</span><span class="s">&quot;b3&quot;</span><span class="p">,</span> <span class="s">&quot;b4&quot;</span><span class="p">)</span>
    <span class="n">n4</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">nst4</span><span class="p">)</span>
    <span class="n">ts</span> <span class="o">=</span> <span class="n">TreeStyle</span><span class="p">()</span>
    <span class="n">ts</span><span class="o">.</span><span class="n">layout_fn</span> <span class="o">=</span> <span class="n">layout</span>
    <span class="n">ts</span><span class="o">.</span><span class="n">show_leaf_name</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="n">ts</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s">&quot;c&quot;</span>
    <span class="n">ts</span><span class="o">.</span><span class="n">root_opening_factor</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">t</span><span class="p">,</span> <span class="n">ts</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">ts</span> <span class="o">=</span> <span class="n">get_example_tree</span><span class="p">()</span>
    <span class="c">#t.render(&quot;node_background.png&quot;, w=400, tree_style=ts)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">tree_style</span><span class="o">=</span><span class="n">ts</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="img-faces">
<h3><a class="toc-backref" href="#id30">Img Faces</a><a class="headerlink" href="#img-faces" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><div class="figure">
<img alt="../_images/img_faces.png" src="../_images/img_faces.png" />
</div>
</div></blockquote>
<p>Note that images are attached to terminal and internal nodes.</p>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre><span class="c"># Import Tree instance and faces module</span>
<span class="kn">from</span> <span class="nn">ete3</span> <span class="kn">import</span> <span class="n">Tree</span><span class="p">,</span> <span class="n">faces</span><span class="p">,</span> <span class="n">TreeStyle</span>

<span class="c"># Loads an example tree</span>
<span class="n">nw</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span>
<span class="s">(((Dre:0.008339,Dme:0.300613)1.000000:0.596401,</span>
<span class="s">(Cfa:0.640858,Hsa:0.753230)1.000000:0.182035)1.000000:0.106234,</span>
<span class="s">((Dre:0.271621,Cfa:0.046042)1.000000:0.953250,</span>
<span class="s">(Hsa:0.061813,Mms:0.110769)1.000000:0.204419)1.000000:0.973467);</span>
<span class="s">&quot;&quot;&quot;</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="n">nw</span><span class="p">)</span>

<span class="c"># You can create any random tree containing the same leaf names, and</span>
<span class="c"># layout will work equally</span>
<span class="c">#</span>
<span class="c"># t = Tree()</span>
<span class="c"># Creates a random tree with 8 leaves using a given set of names</span>
<span class="c"># t.populate(8, [&quot;Dme&quot;, &quot;Dre&quot;, &quot;Hsa&quot;, &quot;Ptr&quot;, &quot;Cfa&quot;, &quot;Mms&quot;])</span>

<span class="c"># Set the path in which images are located</span>
<span class="n">img_path</span> <span class="o">=</span> <span class="s">&quot;./&quot;</span>
<span class="c"># Create faces based on external images</span>
<span class="n">humanFace</span> <span class="o">=</span> <span class="n">faces</span><span class="o">.</span><span class="n">ImgFace</span><span class="p">(</span><span class="n">img_path</span><span class="o">+</span><span class="s">&quot;human.png&quot;</span><span class="p">)</span>
<span class="n">mouseFace</span> <span class="o">=</span> <span class="n">faces</span><span class="o">.</span><span class="n">ImgFace</span><span class="p">(</span><span class="n">img_path</span><span class="o">+</span><span class="s">&quot;mouse.png&quot;</span><span class="p">)</span>
<span class="n">dogFace</span> <span class="o">=</span> <span class="n">faces</span><span class="o">.</span><span class="n">ImgFace</span><span class="p">(</span><span class="n">img_path</span><span class="o">+</span><span class="s">&quot;dog.png&quot;</span><span class="p">)</span>
<span class="n">chimpFace</span> <span class="o">=</span> <span class="n">faces</span><span class="o">.</span><span class="n">ImgFace</span><span class="p">(</span><span class="n">img_path</span><span class="o">+</span><span class="s">&quot;chimp.png&quot;</span><span class="p">)</span>
<span class="n">fishFace</span> <span class="o">=</span> <span class="n">faces</span><span class="o">.</span><span class="n">ImgFace</span><span class="p">(</span><span class="n">img_path</span><span class="o">+</span><span class="s">&quot;fish.png&quot;</span><span class="p">)</span>
<span class="n">flyFace</span> <span class="o">=</span> <span class="n">faces</span><span class="o">.</span><span class="n">ImgFace</span><span class="p">(</span><span class="n">img_path</span><span class="o">+</span><span class="s">&quot;fly.png&quot;</span><span class="p">)</span>

<span class="c"># Create a faces ready to read the name attribute of nodes</span>
<span class="c">#nameFace = faces.TextFace(open(&quot;text&quot;).readline().strip(), fsize=20, fgcolor=&quot;#009000&quot;)</span>
<span class="n">nameFace</span> <span class="o">=</span> <span class="n">faces</span><span class="o">.</span><span class="n">AttrFace</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">,</span> <span class="n">fsize</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">fgcolor</span><span class="o">=</span><span class="s">&quot;#009000&quot;</span><span class="p">)</span>

<span class="c"># Create a conversion between leaf names and real names</span>
<span class="n">code2name</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">&quot;Dre&quot;</span><span class="p">:</span><span class="s">&quot;Drosophila melanogaster&quot;</span><span class="p">,</span>
        <span class="s">&quot;Dme&quot;</span><span class="p">:</span><span class="s">&quot;Danio rerio&quot;</span><span class="p">,</span>
        <span class="s">&quot;Hsa&quot;</span><span class="p">:</span><span class="s">&quot;Homo sapiens&quot;</span><span class="p">,</span>
        <span class="s">&quot;Ptr&quot;</span><span class="p">:</span><span class="s">&quot;Pan troglodytes&quot;</span><span class="p">,</span>
        <span class="s">&quot;Mms&quot;</span><span class="p">:</span><span class="s">&quot;Mus musculus&quot;</span><span class="p">,</span>
        <span class="s">&quot;Cfa&quot;</span><span class="p">:</span><span class="s">&quot;Canis familiaris&quot;</span>
        <span class="p">}</span>

<span class="c"># Creates a dictionary with the descriptions of each leaf name</span>
<span class="n">code2desc</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">&quot;Dre&quot;</span><span class="p">:</span><span class="s">&quot;&quot;&quot;The zebrafish, also known as Danio rerio,</span>
<span class="s">is a tropical freshwater fish belonging to the</span>
<span class="s">minnow family (Cyprinidae).&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="s">&quot;Dme&quot;</span><span class="p">:</span><span class="s">&quot;&quot;&quot;True flies are insects of the order Diptera,</span>
<span class="s">possessing a single pair of wings on the</span>
<span class="s">mesothorax and a pair of halteres, derived from</span>
<span class="s">the hind wings, on the metathorax&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="s">&quot;Hsa&quot;</span><span class="p">:</span><span class="s">&quot;&quot;&quot;A human is a member of a species</span>
<span class="s">of bipedal primates in the family Hominidae.&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="s">&quot;Ptr&quot;</span><span class="p">:</span><span class="s">&quot;&quot;&quot;Chimpanzee, sometimes colloquially</span>
<span class="s">chimp, is the common name for the</span>
<span class="s">two extant species of ape in the genus Pan.&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="s">&quot;Mms&quot;</span><span class="p">:</span><span class="s">&quot;&quot;&quot;A mouse is a small mammal belonging to the</span>
<span class="s">order of rodents.&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="s">&quot;Cfa&quot;</span><span class="p">:</span> <span class="s">&quot;&quot;&quot;The dog (Canis lupus familiaris) is a</span>
<span class="s">domesticated subspecies of the Gray Wolf,</span>
<span class="s">a member of the Canidae family of the</span>
<span class="s">orderCarnivora.&quot;&quot;&quot;</span>
        <span class="p">}</span>

<span class="c"># Creates my own layout function. I will use all previously created</span>
<span class="c"># faces and will set different node styles depending on the type of</span>
<span class="c"># node.</span>
<span class="k">def</span> <span class="nf">mylayout</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
    <span class="c"># If node is a leaf, add the nodes name and a its scientific</span>
    <span class="c"># name</span>
    <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">is_leaf</span><span class="p">():</span>
        <span class="c"># Add an static face that handles the node name</span>
        <span class="n">faces</span><span class="o">.</span><span class="n">add_face_to_node</span><span class="p">(</span><span class="n">nameFace</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="c"># We can also create faces on the fly</span>
        <span class="n">longNameFace</span> <span class="o">=</span> <span class="n">faces</span><span class="o">.</span><span class="n">TextFace</span><span class="p">(</span><span class="n">code2name</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">])</span>
        <span class="n">faces</span><span class="o">.</span><span class="n">add_face_to_node</span><span class="p">(</span><span class="n">longNameFace</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="c"># text faces support multiline. We add a text face</span>
        <span class="c"># with the whole description of each leaf.</span>
        <span class="n">descFace</span> <span class="o">=</span> <span class="n">faces</span><span class="o">.</span><span class="n">TextFace</span><span class="p">(</span><span class="n">code2desc</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">],</span> <span class="n">fsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">descFace</span><span class="o">.</span><span class="n">margin_top</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="n">descFace</span><span class="o">.</span><span class="n">margin_bottom</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="n">descFace</span><span class="o">.</span><span class="n">border</span><span class="o">.</span><span class="n">margin</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="c"># Note that this faces is added in &quot;aligned&quot; mode</span>
        <span class="n">faces</span><span class="o">.</span><span class="n">add_face_to_node</span><span class="p">(</span><span class="n">descFace</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">aligned</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="c"># Sets the style of leaf nodes</span>
        <span class="n">node</span><span class="o">.</span><span class="n">img_style</span><span class="p">[</span><span class="s">&quot;size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>
        <span class="n">node</span><span class="o">.</span><span class="n">img_style</span><span class="p">[</span><span class="s">&quot;shape&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;circle&quot;</span>
    <span class="c">#If node is an internal node</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c"># Sets the style of internal nodes</span>
        <span class="n">node</span><span class="o">.</span><span class="n">img_style</span><span class="p">[</span><span class="s">&quot;size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">6</span>
        <span class="n">node</span><span class="o">.</span><span class="n">img_style</span><span class="p">[</span><span class="s">&quot;shape&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;circle&quot;</span>
        <span class="n">node</span><span class="o">.</span><span class="n">img_style</span><span class="p">[</span><span class="s">&quot;fgcolor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;#000000&quot;</span>

    <span class="c"># If an internal node contains more than 4 leaves, add the</span>
    <span class="c"># images of the represented species sorted in columns of 2</span>
    <span class="c"># images max.</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">4</span><span class="p">:</span>
        <span class="n">col</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">get_leaf_names</span><span class="p">())):</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">&gt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">i</span><span class="o">%</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">col</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="c"># Add the corresponding face to the node</span>
            <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;Dme&quot;</span><span class="p">):</span>
                <span class="n">faces</span><span class="o">.</span><span class="n">add_face_to_node</span><span class="p">(</span><span class="n">flyFace</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">col</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;Dre&quot;</span><span class="p">):</span>
                <span class="n">faces</span><span class="o">.</span><span class="n">add_face_to_node</span><span class="p">(</span><span class="n">fishFace</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">col</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;Mms&quot;</span><span class="p">):</span>
                <span class="n">faces</span><span class="o">.</span><span class="n">add_face_to_node</span><span class="p">(</span><span class="n">mouseFace</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">col</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;Ptr&quot;</span><span class="p">):</span>
                <span class="n">faces</span><span class="o">.</span><span class="n">add_face_to_node</span><span class="p">(</span><span class="n">chimpFace</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">col</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;Hsa&quot;</span><span class="p">):</span>
                <span class="n">faces</span><span class="o">.</span><span class="n">add_face_to_node</span><span class="p">(</span><span class="n">humanFace</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">col</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;Cfa&quot;</span><span class="p">):</span>
                <span class="n">faces</span><span class="o">.</span><span class="n">add_face_to_node</span><span class="p">(</span><span class="n">dogFace</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">col</span><span class="p">)</span>

            <span class="c"># Modifies this node&#39;s style</span>
            <span class="n">node</span><span class="o">.</span><span class="n">img_style</span><span class="p">[</span><span class="s">&quot;size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">16</span>
            <span class="n">node</span><span class="o">.</span><span class="n">img_style</span><span class="p">[</span><span class="s">&quot;shape&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;sphere&quot;</span>
            <span class="n">node</span><span class="o">.</span><span class="n">img_style</span><span class="p">[</span><span class="s">&quot;fgcolor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;#AA0000&quot;</span>

    <span class="c"># If leaf is &quot;Hsa&quot; (homo sapiens), highlight it using a</span>
    <span class="c"># different background.</span>
    <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">is_leaf</span><span class="p">()</span> <span class="ow">and</span> <span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&quot;Hsa&quot;</span><span class="p">):</span>
        <span class="n">node</span><span class="o">.</span><span class="n">img_style</span><span class="p">[</span><span class="s">&quot;bgcolor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&quot;#9db0cf&quot;</span>

<span class="c"># And, finally, Visualize the tree using my own layout function</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">TreeStyle</span><span class="p">()</span>
<span class="n">ts</span><span class="o">.</span><span class="n">layout_fn</span> <span class="o">=</span> <span class="n">mylayout</span>
<span class="n">t</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s">&quot;img_faces.png&quot;</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">tree_style</span> <span class="o">=</span> <span class="n">ts</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="bubble-tree-maps">
<h3><a class="toc-backref" href="#id31">Bubble tree maps</a><a class="headerlink" href="#bubble-tree-maps" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><div class="figure">
<img alt="../_images/bubble_map.png" src="../_images/bubble_map.png" />
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">ete3</span> <span class="kn">import</span> <span class="n">Tree</span><span class="p">,</span> <span class="n">TreeStyle</span><span class="p">,</span> <span class="n">NodeStyle</span><span class="p">,</span> <span class="n">faces</span><span class="p">,</span> <span class="n">AttrFace</span><span class="p">,</span> <span class="n">CircleFace</span>

<span class="k">def</span> <span class="nf">layout</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">is_leaf</span><span class="p">():</span>
        <span class="c"># Add node name to laef nodes</span>
        <span class="n">N</span> <span class="o">=</span> <span class="n">AttrFace</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">,</span> <span class="n">fsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fgcolor</span><span class="o">=</span><span class="s">&quot;black&quot;</span><span class="p">)</span>
        <span class="n">faces</span><span class="o">.</span><span class="n">add_face_to_node</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="s">&quot;weight&quot;</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">features</span><span class="p">:</span>
        <span class="c"># Creates a sphere face whose size is proportional to node&#39;s</span>
        <span class="c"># feature &quot;weight&quot;</span>
        <span class="n">C</span> <span class="o">=</span> <span class="n">CircleFace</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">weight</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&quot;RoyalBlue&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s">&quot;sphere&quot;</span><span class="p">)</span>
        <span class="c"># Let&#39;s make the sphere transparent</span>
        <span class="n">C</span><span class="o">.</span><span class="n">opacity</span> <span class="o">=</span> <span class="mf">0.3</span>
        <span class="c"># And place as a float face over the tree</span>
        <span class="n">faces</span><span class="o">.</span><span class="n">add_face_to_node</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s">&quot;float&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_example_tree</span><span class="p">():</span>
    <span class="c"># Random tree</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">()</span>
    <span class="n">t</span><span class="o">.</span><span class="n">populate</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="n">random_branches</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="c"># Some random features in all nodes</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">traverse</span><span class="p">():</span>
        <span class="n">n</span><span class="o">.</span><span class="n">add_features</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>

    <span class="c"># Create an empty TreeStyle</span>
    <span class="n">ts</span> <span class="o">=</span> <span class="n">TreeStyle</span><span class="p">()</span>

    <span class="c"># Set our custom layout function</span>
    <span class="n">ts</span><span class="o">.</span><span class="n">layout_fn</span> <span class="o">=</span> <span class="n">layout</span>

    <span class="c"># Draw a tree</span>
    <span class="n">ts</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s">&quot;c&quot;</span>

    <span class="c"># We will add node names manually</span>
    <span class="n">ts</span><span class="o">.</span><span class="n">show_leaf_name</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="c"># Show branch data</span>
    <span class="n">ts</span><span class="o">.</span><span class="n">show_branch_length</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="n">ts</span><span class="o">.</span><span class="n">show_branch_support</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">return</span> <span class="n">t</span><span class="p">,</span> <span class="n">ts</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">ts</span> <span class="o">=</span> <span class="n">get_example_tree</span><span class="p">()</span>

    <span class="c">#t.render(&quot;bubble_map.png&quot;, w=600, dpi=300, tree_style=ts)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">tree_style</span><span class="o">=</span><span class="n">ts</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="trees-within-trees">
<h3><a class="toc-backref" href="#id32">Trees within trees</a><a class="headerlink" href="#trees-within-trees" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><div class="figure">
<img alt="../_images/tree_faces.png" src="../_images/tree_faces.png" />
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">ete3</span> <span class="kn">import</span> <span class="n">Tree</span><span class="p">,</span> <span class="n">TreeStyle</span><span class="p">,</span> <span class="n">NodeStyle</span><span class="p">,</span> <span class="n">faces</span><span class="p">,</span> <span class="n">AttrFace</span><span class="p">,</span> <span class="n">TreeFace</span>

<span class="c"># Tree Style used to render small trees used as leaf faces</span>
<span class="n">small_ts</span> <span class="o">=</span> <span class="n">TreeStyle</span><span class="p">()</span>
<span class="n">small_ts</span><span class="o">.</span><span class="n">show_leaf_name</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">small_ts</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="mi">10</span>

<span class="k">def</span> <span class="nf">layout</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">is_leaf</span><span class="p">():</span>
        <span class="c"># Add node name to laef nodes</span>
        <span class="n">N</span> <span class="o">=</span> <span class="n">AttrFace</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">,</span> <span class="n">fsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fgcolor</span><span class="o">=</span><span class="s">&quot;black&quot;</span><span class="p">)</span>
        <span class="n">faces</span><span class="o">.</span><span class="n">add_face_to_node</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">t</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">()</span>
        <span class="n">t</span><span class="o">.</span><span class="n">populate</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

        <span class="n">T</span> <span class="o">=</span> <span class="n">TreeFace</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">small_ts</span><span class="p">)</span>
        <span class="c"># Let&#39;s make the sphere transparent</span>
        <span class="n">T</span><span class="o">.</span><span class="n">opacity</span> <span class="o">=</span> <span class="mf">0.8</span>
        <span class="c"># And place as a float face over the tree</span>
        <span class="n">faces</span><span class="o">.</span><span class="n">add_face_to_node</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s">&quot;aligned&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_example_tree</span><span class="p">():</span>
    <span class="c"># Random tree</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">()</span>
    <span class="n">t</span><span class="o">.</span><span class="n">populate</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="n">random_branches</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="c"># Some random features in all nodes</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">traverse</span><span class="p">():</span>
        <span class="n">n</span><span class="o">.</span><span class="n">add_features</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>

    <span class="c"># Create an empty TreeStyle</span>
    <span class="n">ts</span> <span class="o">=</span> <span class="n">TreeStyle</span><span class="p">()</span>

    <span class="c"># Set our custom layout function</span>
    <span class="n">ts</span><span class="o">.</span><span class="n">layout_fn</span> <span class="o">=</span> <span class="n">layout</span>

    <span class="c"># Draw a tree</span>
    <span class="n">ts</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s">&quot;c&quot;</span>

    <span class="c"># We will add node names manually</span>
    <span class="n">ts</span><span class="o">.</span><span class="n">show_leaf_name</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="c"># Show branch data</span>
    <span class="n">ts</span><span class="o">.</span><span class="n">show_branch_length</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="n">ts</span><span class="o">.</span><span class="n">show_branch_support</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="n">t</span><span class="p">,</span> <span class="n">ts</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">ts</span> <span class="o">=</span> <span class="n">get_example_tree</span><span class="p">()</span>
    <span class="c">#t.render(&quot;tree_faces.png&quot;, w=600, dpi=300, tree_style=ts)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">tree_style</span><span class="o">=</span><span class="n">ts</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="phylogenetic-trees-and-sequence-domains">
<h3><a class="toc-backref" href="#id33">Phylogenetic trees and sequence domains</a><a class="headerlink" href="#phylogenetic-trees-and-sequence-domains" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><div class="figure">
<img alt="../_images/seq_motif_faces.png" src="../_images/seq_motif_faces.png" />
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">ete3</span> <span class="kn">import</span> <span class="n">Tree</span><span class="p">,</span> <span class="n">SeqMotifFace</span><span class="p">,</span> <span class="n">TreeStyle</span><span class="p">,</span> <span class="n">add_face_to_node</span>

<span class="n">seq</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;-----------------------------------------------AQAK---IKGSKKAIKVFSSA---&quot;</span>
      <span class="s">&quot;APERLQEYGSIFTDA---GLQRRPRHRIQSK-------ALQEKLKDFPVCVSTKPEPEDDAEEGLGGLPSN&quot;</span>
      <span class="s">&quot;ISSVSSLLLFNTTENLYKKYVFLDPLAG----THVMLGAETEEKLFDAPLSISKREQLEQQVPENYFYVPD&quot;</span>
      <span class="s">&quot;LGQVPEIDVPSYLPDLPGIANDLMYIADLGPGIAPSAPGTIPELPTFHTEVAEPLKVGELGSGMGAGPGTP&quot;</span>
      <span class="s">&quot;AHTPSSLDTPHFVFQTYKMGAPPLPPSTAAPVGQGARQDDSSSSASPSVQGAPREVVDPSGGWATLLESIR&quot;</span>
      <span class="s">&quot;QAGGIGKAKLRSMKERKLEKQQQKEQEQVRATSQGGHL--MSDLFNKLVMRRKGISGKGPGAGDGPGGAFA&quot;</span>
      <span class="s">&quot;RVSDSIPPLPPPQQPQAEDED----&quot;</span><span class="p">)</span>

<span class="n">mixed_motifs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="c"># seq.start, seq.end, shape, width, height, fgcolor, bgcolor</span>
        <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s">&quot;[]&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="s">&quot;rgradient:blue&quot;</span><span class="p">,</span> <span class="s">&quot;arial|8|white|long text clipped long text clipped&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">101</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="s">&quot;o&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s">&quot;blue&quot;</span><span class="p">,</span> <span class="s">&quot;pink&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">155</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="s">&quot;()&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s">&quot;blue&quot;</span><span class="p">,</span> <span class="s">&quot;rgradient:purple&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">160</span><span class="p">,</span> <span class="mi">190</span><span class="p">,</span> <span class="s">&quot;^&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="s">&quot;yellow&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">191</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="s">&quot;&lt;&gt;&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="s">&quot;rgradient:orange&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">201</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="s">&quot;o&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="s">&quot;brown&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">351</span><span class="p">,</span> <span class="mi">370</span><span class="p">,</span> <span class="s">&quot;v&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="s">&quot;rgradient:gold&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">370</span><span class="p">,</span> <span class="mi">420</span><span class="p">,</span> <span class="s">&quot;compactseq&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">simple_motifs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="c"># seq.start, seq.end, shape, width, height, fgcolor, bgcolor</span>
        <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="s">&quot;[]&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="s">&quot;rgradient:blue&quot;</span><span class="p">,</span> <span class="s">&quot;arial|8|white|long text clipped long text clipped&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">120</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="s">&quot;o&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s">&quot;blue&quot;</span><span class="p">,</span> <span class="s">&quot;pink&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="s">&quot;()&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s">&quot;blue&quot;</span><span class="p">,</span> <span class="s">&quot;red&quot;</span><span class="p">,</span> <span class="s">&quot;arial|8|white|hello&quot;</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">box_motifs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="c"># seq.start, seq.end, shape, width, height, fgcolor, bgcolor</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span> <span class="s">&quot;[]&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="s">&quot;rgradient:blue&quot;</span><span class="p">,</span> <span class="s">&quot;arial|8|white|10&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="s">&quot;[]&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="s">&quot;rgradient:ref&quot;</span><span class="p">,</span> <span class="s">&quot;arial|8|white|10&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="s">&quot;[]&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="s">&quot;rgradient:orange&quot;</span><span class="p">,</span> <span class="s">&quot;arial|8|white|20&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="s">&quot;[]&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="s">&quot;rgradient:pink&quot;</span><span class="p">,</span> <span class="s">&quot;arial|8|white|20&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">70</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="s">&quot;[]&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="s">&quot;rgradient:green&quot;</span><span class="p">,</span> <span class="s">&quot;arial|8|white|20&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">90</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="s">&quot;[]&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="s">&quot;rgradient:brown&quot;</span><span class="p">,</span> <span class="s">&quot;arial|8|white|20&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">110</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="s">&quot;[]&quot;</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s">&quot;black&quot;</span><span class="p">,</span> <span class="s">&quot;rgradient:yellow&quot;</span><span class="p">,</span> <span class="s">&quot;arial|8|white|20&quot;</span><span class="p">],</span>
<span class="p">]</span>

<span class="k">def</span> <span class="nf">get_example_tree</span><span class="p">():</span>
        <span class="c"># Create a random tree and add to each leaf a random set of motifs</span>
        <span class="c"># from the original set</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="s">&quot;( (A, B, C, D, E, F, G), H, I);&quot;</span><span class="p">)</span>

        <span class="n">seqFace</span> <span class="o">=</span> <span class="n">SeqMotifFace</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">gapcolor</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">)</span>
        <span class="p">(</span><span class="n">t</span> <span class="o">&amp;</span> <span class="s">&quot;A&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">add_face</span><span class="p">(</span><span class="n">seqFace</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;aligned&quot;</span><span class="p">)</span>

        <span class="n">seqFace</span> <span class="o">=</span> <span class="n">SeqMotifFace</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">seq_format</span><span class="o">=</span><span class="s">&quot;line&quot;</span><span class="p">,</span> <span class="n">gap_format</span><span class="o">=</span><span class="s">&quot;blank&quot;</span><span class="p">)</span>
        <span class="p">(</span><span class="n">t</span> <span class="o">&amp;</span> <span class="s">&quot;B&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">add_face</span><span class="p">(</span><span class="n">seqFace</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;aligned&quot;</span><span class="p">)</span>

        <span class="n">seqFace</span> <span class="o">=</span> <span class="n">SeqMotifFace</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">seq_format</span><span class="o">=</span><span class="s">&quot;line&quot;</span><span class="p">)</span>
        <span class="p">(</span><span class="n">t</span> <span class="o">&amp;</span> <span class="s">&quot;C&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">add_face</span><span class="p">(</span><span class="n">seqFace</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;aligned&quot;</span><span class="p">)</span>
        
        <span class="n">seqFace</span> <span class="o">=</span> <span class="n">SeqMotifFace</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">seq_format</span><span class="o">=</span><span class="s">&quot;()&quot;</span><span class="p">)</span>
        <span class="p">(</span><span class="n">t</span> <span class="o">&amp;</span> <span class="s">&quot;D&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">add_face</span><span class="p">(</span><span class="n">seqFace</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;aligned&quot;</span><span class="p">)</span>

        <span class="n">seqFace</span> <span class="o">=</span> <span class="n">SeqMotifFace</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">motifs</span><span class="o">=</span><span class="n">simple_motifs</span><span class="p">,</span> <span class="n">seq_format</span><span class="o">=</span><span class="s">&quot;-&quot;</span><span class="p">)</span>
        <span class="p">(</span><span class="n">t</span> <span class="o">&amp;</span> <span class="s">&quot;E&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">add_face</span><span class="p">(</span><span class="n">seqFace</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;aligned&quot;</span><span class="p">)</span>

        <span class="n">seqFace</span> <span class="o">=</span> <span class="n">SeqMotifFace</span><span class="p">(</span><span class="n">seq</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">motifs</span><span class="o">=</span><span class="n">simple_motifs</span><span class="p">,</span> <span class="n">gap_format</span><span class="o">=</span><span class="s">&quot;blank&quot;</span><span class="p">)</span>
        <span class="p">(</span><span class="n">t</span> <span class="o">&amp;</span> <span class="s">&quot;F&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">add_face</span><span class="p">(</span><span class="n">seqFace</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;aligned&quot;</span><span class="p">)</span>

        <span class="n">seqFace</span> <span class="o">=</span> <span class="n">SeqMotifFace</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">motifs</span><span class="o">=</span><span class="n">mixed_motifs</span><span class="p">,</span> <span class="n">seq_format</span><span class="o">=</span><span class="s">&quot;-&quot;</span><span class="p">)</span>
        <span class="p">(</span><span class="n">t</span> <span class="o">&amp;</span> <span class="s">&quot;G&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">add_face</span><span class="p">(</span><span class="n">seqFace</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;aligned&quot;</span><span class="p">)</span>

        
        <span class="n">seqFace</span> <span class="o">=</span> <span class="n">SeqMotifFace</span><span class="p">(</span><span class="n">seq</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">motifs</span><span class="o">=</span><span class="n">box_motifs</span><span class="p">,</span> <span class="n">gap_format</span><span class="o">=</span><span class="s">&quot;line&quot;</span><span class="p">)</span>
        <span class="p">(</span><span class="n">t</span> <span class="o">&amp;</span> <span class="s">&quot;H&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">add_face</span><span class="p">(</span><span class="n">seqFace</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;aligned&quot;</span><span class="p">)</span>


        <span class="n">seqFace</span> <span class="o">=</span> <span class="n">SeqMotifFace</span><span class="p">(</span><span class="n">seq</span><span class="p">[</span><span class="mi">30</span><span class="p">:</span><span class="mi">60</span><span class="p">],</span> <span class="n">seq_format</span><span class="o">=</span><span class="s">&quot;seq&quot;</span><span class="p">)</span>
        <span class="p">(</span><span class="n">t</span> <span class="o">&amp;</span> <span class="s">&quot;I&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">add_face</span><span class="p">(</span><span class="n">seqFace</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;aligned&quot;</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">t</span>
        
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">get_example_tree</span><span class="p">()</span>
    <span class="n">ts</span> <span class="o">=</span> <span class="n">TreeStyle</span><span class="p">()</span>
    <span class="n">ts</span><span class="o">.</span><span class="n">tree_width</span> <span class="o">=</span> <span class="mi">50</span>
    <span class="c">#t.show(tree_style=ts)</span>
    <span class="n">t</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s">&quot;seq_motif_faces.png&quot;</span><span class="p">,</span> <span class="n">tree_style</span><span class="o">=</span><span class="n">ts</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="creating-your-custom-interactive-item-faces">
<h3><a class="toc-backref" href="#id34">Creating your custom interactive Item faces</a><a class="headerlink" href="#creating-your-custom-interactive-item-faces" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><div class="figure">
<img alt="../_images/item_faces.png" src="../_images/item_faces.png" />
</div>
</div></blockquote>
<p>Note that item faces shown in this image are not static. When the tree
is view using the tree.show() method, you can interact with items.</p>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre><span class="c"># We will need to create Qt4 items</span>
<span class="kn">from</span> <span class="nn">PyQt4</span> <span class="kn">import</span> <span class="n">QtCore</span>
<span class="kn">from</span> <span class="nn">PyQt4.QtGui</span> <span class="kn">import</span> <span class="n">QGraphicsRectItem</span><span class="p">,</span> <span class="n">QGraphicsSimpleTextItem</span><span class="p">,</span> \
    <span class="n">QGraphicsEllipseItem</span><span class="p">,</span> <span class="n">QColor</span><span class="p">,</span> <span class="n">QPen</span><span class="p">,</span> <span class="n">QBrush</span>

<span class="kn">from</span> <span class="nn">ete3</span> <span class="kn">import</span> <span class="n">Tree</span><span class="p">,</span> <span class="n">faces</span><span class="p">,</span> <span class="n">TreeStyle</span><span class="p">,</span> <span class="n">NodeStyle</span>

<span class="c"># To play with random colors</span>
<span class="kn">import</span> <span class="nn">colorsys</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="k">class</span> <span class="nc">InteractiveItem</span><span class="p">(</span><span class="n">QGraphicsRectItem</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">arg</span><span class="p">,</span> <span class="o">**</span><span class="n">karg</span><span class="p">):</span>
        <span class="n">QGraphicsRectItem</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">arg</span><span class="p">,</span> <span class="o">**</span><span class="n">karg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">node</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setCursor</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">PointingHandCursor</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setAcceptsHoverEvents</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">hoverEnterEvent</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="c"># There are many ways of adding interactive elements. With the</span>
        <span class="c"># following code, I show/hide a text item over my custom</span>
        <span class="c"># DynamicItemFace</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">QGraphicsRectItem</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">setParentItem</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="c"># This is to ensure that the label is rendered over the</span>
            <span class="c"># rest of item children (default ZValue for items is 0)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">setZValue</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">QBrush</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span><span class="s">&quot;white&quot;</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">QGraphicsSimpleTextItem</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">setParentItem</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">setRect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">hoverLeaveEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">random_color</span><span class="p">(</span><span class="n">h</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Generates a random color in RGB format.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">h</span><span class="p">:</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
    <span class="n">s</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="n">l</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="k">return</span> <span class="n">_hls2hex</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_hls2hex</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="s">&#39;#</span><span class="si">%02x%02x%02x</span><span class="s">&#39;</span> <span class="o">%</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="mi">255</span><span class="p">),</span>
                                      <span class="n">colorsys</span><span class="o">.</span><span class="n">hls_to_rgb</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">s</span><span class="p">)))</span>

<span class="k">def</span> <span class="nf">ugly_name_face</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; This is my item generator. It must receive a node object, and</span>
<span class="sd">    returns a Qt4 graphics item that can be used as a node face.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c"># receive an arbitrary number of arguments, in this case width and</span>
    <span class="c"># height of the faces</span>
    <span class="n">width</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">height</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

    <span class="c">## Creates a main master Item that will contain all other elements</span>
    <span class="c">## Items can be standard QGraphicsItem</span>
    <span class="c"># masterItem = QGraphicsRectItem(0, 0, width, height)</span>

    <span class="c"># Or your custom Items, in which you can re-implement interactive</span>
    <span class="c"># functions, etc. Check QGraphicsItem doc for details.</span>
    <span class="n">masterItem</span> <span class="o">=</span> <span class="n">InteractiveItem</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>

    <span class="c"># Keep a link within the item to access node info</span>
    <span class="n">masterItem</span><span class="o">.</span><span class="n">node</span> <span class="o">=</span> <span class="n">node</span>

    <span class="c"># I dont want a border around the masterItem</span>
    <span class="n">masterItem</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QPen</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">NoPen</span><span class="p">))</span>

    <span class="c"># Add ellipse around text</span>
    <span class="n">ellipse</span> <span class="o">=</span> <span class="n">QGraphicsEllipseItem</span><span class="p">(</span><span class="n">masterItem</span><span class="o">.</span><span class="n">rect</span><span class="p">())</span>
    <span class="n">ellipse</span><span class="o">.</span><span class="n">setParentItem</span><span class="p">(</span><span class="n">masterItem</span><span class="p">)</span>
    <span class="c"># Change ellipse color</span>
    <span class="n">ellipse</span><span class="o">.</span><span class="n">setBrush</span><span class="p">(</span><span class="n">QBrush</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span> <span class="n">random_color</span><span class="p">())))</span>

    <span class="c"># Add node name within the ellipse</span>
    <span class="n">text</span> <span class="o">=</span> <span class="n">QGraphicsSimpleTextItem</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="n">text</span><span class="o">.</span><span class="n">setParentItem</span><span class="p">(</span><span class="n">ellipse</span><span class="p">)</span>
    <span class="n">text</span><span class="o">.</span><span class="n">setPen</span><span class="p">(</span><span class="n">QPen</span><span class="p">(</span><span class="n">QPen</span><span class="p">(</span><span class="n">QColor</span><span class="p">(</span><span class="s">&quot;white&quot;</span><span class="p">))))</span>

    <span class="c"># Center text according to masterItem size</span>
    <span class="n">tw</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">width</span><span class="p">()</span>
    <span class="n">th</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
    <span class="n">center</span> <span class="o">=</span> <span class="n">masterItem</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span><span class="o">.</span><span class="n">center</span><span class="p">()</span>
    <span class="n">text</span><span class="o">.</span><span class="n">setPos</span><span class="p">(</span><span class="n">center</span><span class="o">.</span><span class="n">x</span><span class="p">()</span><span class="o">-</span><span class="n">tw</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">center</span><span class="o">.</span><span class="n">y</span><span class="p">()</span><span class="o">-</span><span class="n">th</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">masterItem</span>

<span class="k">def</span> <span class="nf">master_ly</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">is_leaf</span><span class="p">():</span>
        <span class="c"># Create an ItemFAce. First argument must be the pointer to</span>
        <span class="c"># the constructor function that returns a QGraphicsItem. It</span>
        <span class="c"># will be used to draw the Face. Next arguments are arbitrary,</span>
        <span class="c"># and they will be forwarded to the constructor Face function.</span>
        <span class="n">F</span> <span class="o">=</span> <span class="n">faces</span><span class="o">.</span><span class="n">DynamicItemFace</span><span class="p">(</span><span class="n">ugly_name_face</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
        <span class="n">faces</span><span class="o">.</span><span class="n">add_face_to_node</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s">&quot;aligned&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_example_tree</span><span class="p">():</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">()</span>
    <span class="n">t</span><span class="o">.</span><span class="n">populate</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">reuse_names</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="n">ts</span> <span class="o">=</span> <span class="n">TreeStyle</span><span class="p">()</span>
    <span class="n">ts</span><span class="o">.</span><span class="n">layout_fn</span> <span class="o">=</span> <span class="n">master_ly</span>
    <span class="n">ts</span><span class="o">.</span><span class="n">title</span><span class="o">.</span><span class="n">add_face</span><span class="p">(</span><span class="n">faces</span><span class="o">.</span><span class="n">TextFace</span><span class="p">(</span><span class="s">&quot;Drawing your own Qt Faces&quot;</span><span class="p">,</span> <span class="n">fsize</span><span class="o">=</span><span class="mi">15</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">t</span><span class="p">,</span> <span class="n">ts</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">ts</span> <span class="o">=</span> <span class="n">get_example_tree</span><span class="p">()</span>

    <span class="c">#t.render(&quot;item_faces.png&quot;, h=400, tree_style=ts)</span>
    <span class="c"># The interactive features are only available using the GUI</span>
    <span class="n">t</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">tree_style</span><span class="o">=</span><span class="n">ts</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="tutorial_phylogeny.html" class="btn btn-neutral float-right" title="Phylogenetic Trees" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="tutorial_trees.html" class="btn btn-neutral" title="Working With Tree Data Structures" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, The ETE Toolkit Team.
      Last updated on Mar 18, 2016.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'3.0.0b35',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>